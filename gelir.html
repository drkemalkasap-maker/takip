<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Gelir - Gider</title>
<style>
    body { font-family: Arial; text-align: center; }
    hr { width: 300px; }
    .group { margin-bottom: 20px; }
    .row { margin: 5px 0; }
    input{ width: 60px; }
    label { margin-left: 5px; margin-right: 15px; }
    .progress-container {
        position: relative;
        width: 300px;
        height: 20px;
        background-color: #ddd;
        margin: 5px auto;
        border-radius: 10px;
    }
    .progress-bar {
        height: 100%;
        width: 0%;
        background-color: #4caf50;
        border-radius: 10px;
        text-align: center;
        color: white;
        font-size: 12px;
        line-height: 20px;
    }
</style>
</head>
<body>

<!-- Bina -->
<div class="group">
    <h3>Maaş</h3>
    <div class="progress-container">
        <div id="maas_yuzde" class="progress-bar">0%</div>
    </div>
    <div class="row">
        <label>Eski:</label><input id="eski" min="0">
        <label>Bugün:</label><input id="bugün" min="0">
        <label>Maaş:</label><input id="maas" min="0">
    </div>
</div>
<hr>

<button onclick="kaydetTum()">Kaydet</button>
<button onclick="start()">Başlat</button>

<script>
let timer = null; 
const saatlikKazanc = 375; 
const dakikalikKazanc = saatlikKazanc / 60; // 1 dakikada
const saniyelikKazanc = dakikalikKazanc / 60; // 1 saniyede

function start() {
    const btn = event.target;

    if (timer === null) {
        btn.textContent = 'Durdur';

        timer = setInterval(() => {
            let maas = parseFloat(localStorage.getItem('maas')) || 0;
            let eski = parseFloat(localStorage.getItem('eski')) || 0;

            // Şu anki zaman
            const now = new Date();
            let startTime = new Date();
            startTime.setHours(9,30,0,0); // Bugün 9:30

            // Eğer şu an 9:30’dan önceyse, bir önceki gün 9:30’dan başlat
            if (now < startTime) {
                startTime.setDate(startTime.getDate() - 1);
            }

            // Geçen saniye
            let fark = (now - startTime) / 1000;
            if (fark < 0) fark = 0;

            // bugün değerini hesapla
            let bugun = fark * saniyelikKazanc;

            // inputları güncelle
            document.getElementById('bugün').value = Math.round(bugun * 100) / 100;
            document.getElementById('eski').value = Math.round(eski * 100) / 100;

            // yüzde hesapla (eski + bugün)
            let toplam = eski + bugun;
            let yuzde = 0;
            if (maas > 0) {
                yuzde = (toplam / maas) * 100;
                if (yuzde > 100) yuzde = 100;
            }

            const bar = document.getElementById('maas_yuzde');
            bar.style.width = yuzde + '%';
            bar.textContent = yuzde.toFixed(2) + '%';

        }, 1000);
    } else {
        let maas = parseFloat(localStorage.getItem('maas')) || 0;
        let eski = parseFloat(localStorage.getItem('eski')) || 0;
            
        document.getElementById('bugün').value = 0
        btn.textContent = 'Başlat';
        clearInterval(timer);
        timer = null;

        // yüzde hesapla (eski + bugün)
        let toplam = eski + 0;
        let yuzde = 0;
        if (maas > 0) {
            yuzde = (toplam / maas) * 100;
            if (yuzde > 100) yuzde = 100;
        }

        const bar = document.getElementById('maas_yuzde');
        bar.style.width = yuzde + '%';
        bar.textContent = yuzde.toFixed(2) + '%';
    }
}

function kaydetTum() {
    const eskiInput = parseFloat(document.getElementById('eski').value) || 0;
    const maas = parseFloat(document.getElementById('maas').value) || 0;

    // eski değer localStorage'a kaydedilir
    localStorage.setItem('eski', eskiInput);
    localStorage.setItem('maas', maas);

    // yüzde hesapla (eski)
    let toplam = eskiInput;
    let yuzde = 0;
    if (maas > 0) {
        yuzde = (toplam / maas) * 100;
        if (yuzde > 100) yuzde = 100;
    }

    // progress bar'ı güncelle
    const bar = document.getElementById('maas_yuzde');
    bar.style.width = yuzde + '%';
    bar.textContent = yuzde.toFixed(2) + '%';
}

// Sayfa yüklendiğinde değerleri al ve göster
window.onload = function() {
    const eski = parseFloat(localStorage.getItem('eski')) || 0;
    const bugun = parseFloat(localStorage.getItem('bugun')) || 0;
    const maas = parseFloat(localStorage.getItem('maas')) || 0;

    document.getElementById('eski').value = Math.round(eski * 100) / 100;
    document.getElementById('bugün').value = Math.round(bugun * 100) / 100;
    document.getElementById('maas').value = maas;

    let toplam = eski + bugun;
    if (maas > 0) {
        let yuzde = (toplam / maas) * 100;
        if (yuzde > 100) yuzde = 100;
        const bar = document.getElementById('maas_yuzde');
        bar.style.width = yuzde + '%';
        bar.textContent = yuzde.toFixed(2) + '%';
    }
};
</script>


</body>
</html>
